<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css" integrity="sha384-xeJqLiuOvjUBq3iGOjvSQSIlwrpqjSHXpduPd6rQpuiM3f5/ijby8pCsnbu5S81n" crossorigin="anonymous">
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="cal-body">
            <form action="" name="calculator">
                <div class="cal-sreen row">
                    <div class="col-md-12 p-0">
                        <div class="form-group">
                            <div class="top-operation"></div>
                            <input type="text" class="form-control" rows="4" id="total" type="text" name="answer">
                        </div>
                    </div>
                </div>
                <div class="cal-button-row">
                    <!-- 1 -->
                    <div class="row">
                        <div class="col-xs-3">
                            <button type="button" class="btn btn-out">%</button>
                        </div>
                        <div class="col-xs-3">
                            <button type="button" class="btn btn-out">CE</button>
                        </div>
                        <div class="col-xs-3">
                            <button type="button"  id="clear-all" class="btn btn-out">C</button>
                        </div>
                        <div class="col-xs-3">
                            <button type="button" class="btn btn-out"><i class="bi bi-backspace"></i></button>
                        </div>
                    </div>
                    <!-- 2 -->
                    <div class="row">
                        <div class="col-xs-3">
                            <button type="button" class="btn btn-out" disabled>1/x</button>
                        </div>
                        <div class="col-xs-3">
                            <button type="button" class="btn btn-out" disabled>x2</button>
                        </div>
                        <div class="col-xs-3">
                            <button type="button" class="btn btn-out" disabled>2x</button>
                        </div>
                        <div class="col-xs-3">
                            <button type="button" value="/" onclick="divide(value)" id="button-divide" class="btn btn-out">&divide;</button>
                        </div>
                    </div>
                    <!-- 3 -->
                    <div class="row">
                        <div class="col-xs-3">
                            <button type="button" value="7" onclick="getVal(value)" class="btn btn-number">7</button>
                        </div>
                        <div class="col-xs-3">
                            <button type="button" value="8" onclick="getVal(value)" class="btn btn-number">8</button>
                        </div>
                        <div class="col-xs-3">
                            <button type="button" value="9" onclick="getVal(value)" class="btn btn-number">9</button>
                        </div>
                        <div class="col-xs-3">
                            <button type="button" value="*" onclick="multiply(value)" id="button-multiply" class="btn btn-out">x</button>
                        </div>
                    </div>
                    <!-- 4 -->
                    <div class="row">
                        <div class="col-xs-3">
                            <button type="button" value="4" onclick="getVal(value)" class="btn btn-number">4</button>
                        </div>
                        <div class="col-xs-3">
                            <button type="button" value="5" onclick="getVal(value)" class="btn btn-number">5</button>
                        </div>
                        <div class="col-xs-3">
                            <button type="button" value="6" onclick="getVal(value)" class="btn btn-number">6</button>
                        </div>
                        <div class="col-xs-3">
                            <button type="button" value="-" onclick="substract(value)" id="button-substract" class="btn btn-out" >-</button>
                        </div>
                    </div>
                    <!-- 5 -->
                    <div class="row">
                        <div class="col-xs-3">
                            <button type="button" value="1" onclick="getVal(value)" class="btn btn-number">1</button>
                        </div>
                        <div class="col-xs-3">
                            <button type="button" value="2" onclick="getVal(value)" class="btn btn-number">2</button>
                        </div>
                        <div class="col-xs-3 g-2">
                            <button type="button" value="3" onclick="getVal(value)" class="btn btn-number">3</button>
                        </div>
                        <div class="col-xs-3">
                            <button type="button" value="+" onclick="add(value)" id="button-add" class="btn btn-out">+</button>
                        </div>
                    </div>
                    <!-- 6 -->
                    <div class="row">
                        <div class="col-xs-3">
                            <button type="button" class="btn">+/-</button>
                        </div>
                        <div class="col-xs-3">
                            <button type="button" value="0" onclick="getVal(value)" class="btn btn-number">0</button>
                        </div>
                        <div class="col-xs-3">
                            <button type="button" value="." onclick="getVal(value)" class="btn btn-number">.</butto>
                        </div>
                        <div class="col-xs-3">
                            <button type="button" onclick="equal()" class="btn btn-out btn-equal">=</button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <script type="text/javascript">
        const total = document.querySelector('#total');
        const clearAll = document.querySelector('#clear-all');
        const topOperation = document.querySelector('.top-operation');
        let operaton = undefined;
        // click "C" button to clear all result panel
        clearAll.addEventListener('click',clearAllResult)
      
        function clearAllResult(){
            total.value ='';
            topOperation.innerText='';
        }
        
        //get number from button
        function getVal(val){
            total.value = '';
            let string= total.value + val;
            total.value = totalFormat(string);
        }
        
        //format the total display  
        function totalFormat(string){
            const stringTotal = string.split(',').join('');
            const interger = parseFloat(stringTotal.split('.')[0]);
            const decimal = stringTotal.split('.')[1];
            let intergerDisplay;
            if(isNaN(interger)){
                intergerDisplay='';
            }else{
                intergerDisplay = interger.toLocaleString('en',{maximumFractionDigits: 0})
            }

            if(decimal != null){
                return `${intergerDisplay}.${decimal}`;
            }
            else{
                return intergerDisplay;
            }
        }
        function convertToNum(string){
           
            return parseFloat(string.split(',').join(''));
        }
        function add(val){
            operation = val;
            let sum = topOperation.innerText.split(' ')[0];
            if(total.value === '') return;
            if(topOperation.innerText !== ''){
                sum = convertToNum(sum) + convertToNum(total.value);
                total.value = '';
                topOperation.innerText = `${totalFormat(sum.toString())}  ${operation}`;
            }
            else{
                topOperation.innerText = `${total.value}  ${operation}`;
                total.value='';
            }
        }

        function substract(val){
            operation = val;
            let substract = topOperation.innerText.split(' ')[0];
            if(total.value === '') return;
            if(topOperation.innerText !== ''){
                substract = convertToNum(substract) - convertToNum(total.value);
                total.value = '';
                topOperation.innerText = `${totalFormat(substract.toString())}  ${operation}`;
            }
            else{
                topOperation.innerText = `${total.value}  ${operation}`;
                total.value='';
            }
        }

        function multiply(value){
            operation = val;
            let multiply = topOperation.innerText.split(' ')[0];
            if(total.value === '') return;
            if(topOperation.innerText !== ''){
                multiply = convertToNum(multiply) * convertToNum(total.value);
                total.value = '';
                topOperation.innerText = `${totalFormat(multiply.toString())}  ${operation}`;
            }
            else{
                topOperation.innerText = `${total.value}  ${operation}`;
                total.value='';
            }
        }

        function divide(val){
            operation = val;
            let divide = topOperation.innerText.split(' ')[0];
            if(total.value === '') return;
            if(topOperation.innerText !== ''){
                divide = convertToNum(divide) / convertToNum(total.value);
                total.value = '';
                topOperation.innerText = `${totalFormat(divide.toString())}  ${operation}`;
            }
            else{
                topOperation.innerText = `${total.value}  ${operation}`;
                total.value='';
            }
        }

        
        function equal(){
            if(total.value==='' || topOperation.innerText==='') return;
            else{
                total.value =eval( `${total.value} ${operation} ${topOperation.innerText.split(' ')[0]}`);
                console.log(total.value)
                topOperation.innerText ='';
            }
        }
    </script>
</body>
</html>